"use strict";
/**
* @author Emiliya Sokolova
* @version 1.0.0
* @description JavaScript Sitefinity Accordion
*
* @class
* AccordionJS
*/

;

(function (window) {
  var accordion = null,
      activePanelClass = 'is-active',
      accordionPanels = null,
      currentPanel = null,
      childrenLinks = null;
  /**
   *  Contructor
   *
   * @param {containerClass} to enable more than one accordion on a page
   */

  function AccordionFooterJS(containerClass) {
    var accordionContainer = containerClass ? containerClass : '#sf-footer .main-navigation';
    accordion = document.querySelector(accordionContainer);

    if (accordion !== null) {
      _panelWrapper();

      accordionPanels = accordion.querySelectorAll('.sf-accordion-footer__panel');
      childrenLinks = accordion.querySelectorAll('a[href=""]');

      if (accordionPanels.length > 0) {
        _init();
      }
    }
  }
  /**
   * _init method
   */


  function _init() {
    currentPanel = _checkForActivePanelOnLoad();

    if (typeof NodeList.prototype.forEach !== 'function') {
      NodeList.prototype.forEach = Array.prototype.forEach;
    }

    accordionPanels.forEach(function (panel) {
      panel.querySelector('.sf-accordion-footer__trigger-panel').addEventListener('click', _activateSelectedPanel);
    });
  }
  /**
   * begin the activation process on selecting a panel
   * @param  {Event} evt
   * @return {Void}
   */


  function _activateSelectedPanel(evt) {
    evt.preventDefault();

    var selectedPanel = _findAncestor(evt.currentTarget, 'sf-accordion-footer__panel');

    if (currentPanel === selectedPanel && currentPanel.classList.contains(activePanelClass)) {
      currentPanel = selectedPanel;

      _removeCurrentPanel();

      return;
    }

    ;

    _removeCurrentPanel();

    _displaySelectedPanel(selectedPanel);
  }
  /**
   * dispaly the new selected panel
   *
   * @param  {Object} selectedPanel the selected panel
   * @return {Void}
   */


  function _displaySelectedPanel(selectedPanel) {
    selectedPanel.classList.add(activePanelClass);
    var currentContent = selectedPanel.querySelector('.sub-level');
    currentContent.style.display = 'block';
    currentContent.style.height = currentContent.offsetHeight;
    currentContent.style.opacity = 1;
    currentPanel = selectedPanel;
  }
  /**
   * Remove the currently selected panel
   *
   * @return {self} to enable chaining
   */


  function _removeCurrentPanel() {
    if (typeof currentPanel === 'undefined') return this;
    var currentContent = currentPanel.querySelector('.sub-level');
    currentContent.style.opacity = 0;
    currentContent.style.display = 'none';
    currentPanel.classList.remove(activePanelClass);
  }
  /**
   * check to see if the user has enabled a panel on inital page load
   * @return {Object} set to the active panel if set
   */


  function _checkForActivePanelOnLoad() {
    for (var i = 0; i < accordionPanels.length; i++) {
      if (accordionPanels[i].classList.contains(activePanelClass)) {
        return accordionPanels[i];
      }
    }
  }

  function _findAncestor(el, cls) {
    while ((el = el.parentElement) && !el.classList.contains(cls)) {
      ;
    }

    return el;
  }

  function _panelWrapper() {
    var panels = document.querySelectorAll('#sf-footer .main-navigation > li');

    for (var i = 0; i < panels.length; i++) {
      panels[i].classList.add('sf-accordion-footer__panel');
    }

    var el = document.querySelectorAll('#sf-footer .main-navigation > li > a');

    for (var i = 0; i < el.length; i++) {
      var wrapper = document.createElement('div');
      wrapper.classList.add('sf-accordion-footer__header-panel');
      var trigger = document.createElement('span');
      trigger.classList.add('sf-accordion-footer__trigger-panel');
      el[i].parentNode.insertBefore(wrapper, el[i]);
      wrapper.appendChild(el[i]);
      wrapper.insertBefore(trigger, null);
    }
  } //-- return the window object


  window.AccordionFooterJS = AccordionFooterJS;
})(window);

(function () {
  new AccordionFooterJS();
})();
//# sourceMappingURL=accordion-footer-list.min.js.map
