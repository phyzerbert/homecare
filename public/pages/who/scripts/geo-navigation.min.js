"use strict";

// Global vars
var windowWidth = $(window).width();
var desktopMin = 1020;
var geoNavigationContainer = $('#sf-geo-navigation-container');
var geoNavigationContainerMobile = $('.sf-geo-navigation-selector');
var geoNavigation = geoNavigationContainer.find('.sf-primary-geo-navigation');
var geoNavigationMobile = geoNavigationContainerMobile.find('.sf-primary-geo-navigation');
var primaryGeoNavigationListItem = geoNavigation.find('> li');
var primaryGeoNavigationListItemMobile = geoNavigationMobile.find('> li');
var GeoNavigation = {
  primaryLevel: function primaryLevel() {
    primaryGeoNavigationListItem.each(function () {
      var $this = $(this);

      if (!$('.mainnav_overlay').length) {
        $('body').prepend('<div class="mainnav_overlay"></div>');
      }

      $this.on('click', function () {
        var self = $(this);

        if (!$(this).hasClass('open') && $(this).find('.sf-secondary-geo-navigation-container').length) {
          primaryGeoNavigationListItem.removeClass('open');
          primaryGeoNavigationListItem.find('.sf-secondary-geo-navigation-container').slideUp();
          $(this).find('.sf-secondary-geo-navigation-container').slideDown();
          $(this).addClass('open');
          $('body').addClass('geo-navigation-open');
        } else if (!$(this).find('.sf-secondary-geo-navigation-container').length) {
          primaryGeoNavigationListItem.removeClass('open');
          primaryGeoNavigationListItem.find('.sf-secondary-geo-navigation-container').slideUp();
        } else {
          $(this).find('.sf-secondary-geo-navigation-container').slideUp();
          $(this).removeClass('open');
          $('body').removeClass('geo-navigation-open');
        }
      });
      primaryGeoNavigationListItem.on('click', function () {
        if ($(this).hasClass('open')) {
          $('.lazy-navigation-icons').lazy({
            bind: "event",
            delay: 0
          });
        }
      });
    });
    $(document).on('click touchstart', function (e) {
      var subLevel = primaryGeoNavigationListItem.find('.sf-secondary-geo-navigation-container');

      if (!geoNavigationContainer.is(e.target) && geoNavigationContainer.has(e.target).length === 0) {
        if (subLevel.is(":visible")) {
          subLevel.parent().removeClass('open');
          subLevel.slideUp();
          $('body').removeClass('geo-navigation-open');
        }
      }
    });
    $(window).on('resize', function () {
      if ($(this).width() < 768) {
        primaryGeoNavigationListItem.removeClass('open');
        primaryGeoNavigationListItem.find('.sf-secondary-geo-navigation-container').slideUp();
        $('body').removeClass('geo-navigation-open');
      }
    });
  },
  primaryLevelMobile: function primaryLevelMobile() {
    var listElement = $('.sf-geo-navigation-selector .sf-primary-geo-navigation > li');
    listElement.each(function () {
      var $this = $(this);
      $this.on('click touch', function () {
        var self = $(this);

        if (!$(this).hasClass('open') && $(this).find('.sf-secondary-geo-navigation-container').length) {
          listElement.removeClass('open');
          listElement.find('.sf-secondary-geo-navigation-container').animate({
            width: "hide"
          });
          $('.slicknav_menu.open-menu > .slicknav_nav').addClass('secondary-geo-navigation-open');
          $(this).find('.sf-secondary-geo-navigation-container').animate({
            width: "show"
          });
          $(this).addClass('open');
        } else if (!$(this).find('.sf-secondary-geo-navigation-container').length) {
          $('.slicknav_menu.open-menu > .slicknav_nav').removeClass('secondary-geo-navigation-open');
          listElement.removeClass('open');
          listElement.find('.sf-secondary-geo-navigation-container').animate({
            width: "hide"
          });
        } else {
          $('.slicknav_menu.open-menu > .slicknav_nav').removeClass('secondary-geo-navigation-open');
          $(this).removeClass('open');
          $(this).find('.sf-secondary-geo-navigation-container').animate({
            width: "hide"
          });
        }
      });
    });
  },
  svgFillColor: function svgFillColor() {
    $('img.svg').each(function () {
      var $img = $(this);
      var imgID = $img.attr('id');
      var imgClass = $img.attr('class');
      var imgURL = $img.attr('src');

      if (typeof imgURL !== 'undefined') {
        $.get(imgURL, function (data) {
          // Get the SVG tag, ignore the rest
          var $svg = $(data).find('svg'); // Add replaced image's ID to the new SVG

          if (typeof imgID !== 'undefined') {
            $svg = $svg.attr('id', imgID);
          } // Add replaced image's classes to the new SVG


          if (typeof imgClass !== 'undefined') {
            $svg = $svg.attr('class', imgClass + ' replaced-svg');
          } // Remove any invalid XML tags as per http://validator.w3.org


          $svg = $svg.removeAttr('xmlns:a'); // Check if the viewport is set, if the viewport is not set the SVG wont't scale.

          if (!$svg.attr('viewBox') && $svg.attr('height') && $svg.attr('width')) {
            $svg.attr('viewBox', '0 0 ' + $svg.attr('height') + ' ' + $svg.attr('width'));
          } // Replace image with new SVG


          $img.replaceWith($svg);
        }, 'xml');
      }
    });
  },
  init: function init() {
    var self = this;
    $('.slicknav_menu .sf-primary-geo-navigation > li').on('click', function () {
      $('.lazy-navigation-icons').lazy({
        bind: 'event',
        delay: 0
      });
    });

    if ($('#sf-geo-navigation-container').length) {
      self.primaryLevel();
    }

    if ($('.sf-geo-navigation-selector').length) {
      self.svgFillColor();
      self.primaryLevelMobile();
    }
  }
};
$(function () {
  GeoNavigation.init();
});
//# sourceMappingURL=geo-navigation.min.js.map
